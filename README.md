# Аналізатор Графіка Відключень

Desktop додаток для аналізу графіків відключення електроенергії з автоматичним визначенням часових проміжків та експортом в календар.

## Особливості

- Автоматична конвертація зображення до стандартного розміру (1280x335)
- Аналіз графіка з визначенням періодів відключень
- Експорт в календар (ICS) з нагадуваннями за 15 та 5 хвилин
- Порівняння всіх черг з розрахунком загального часу відключень
- Зручний графічний інтерфейс з підтримкою темної теми
- Модульна архітектура для легкої підтримки

## Структура проекту

```
ScheduleAnalyzer/
├── main.py                      # Головний файл запуску
├── analyze_schedule.py          # Алгоритм аналізу графіка
├── ui.py                        # Старий UI файл (deprecated)
├── src/
│   ├── ui/
│   │   └── main_window.py      # Головне вікно додатку
│   ├── utils/
│   │   ├── calendar_export.py  # Експорт в ICS календар
│   │   └── time_calculator.py  # Розрахунок часу відключень
│   └── themes/
│       └── theme_manager.py    # Менеджер тем (light/dark)
├── build_exe.bat               # Скрипт для створення EXE
├── ScheduleAnalyzer.spec       # Конфігурація PyInstaller
└── requirements.txt            # Залежності проекту
```

## Запуск програми

### Варіант 1: EXE файл (рекомендовано)
Просто запустіть `dist/ScheduleAnalyzer.exe` - не потрібна установка Python!

### Варіант 2: З вихідного коду (новий спосіб)
```bash
pip install -r requirements.txt
python main.py
```

### Варіант 3: Старий спосіб (сумісність)
```bash
python ui.py
```

## Як користуватись

1. **Виберіть файл графіку** - зображення будь-якого розміру (автоматично змінить до 1280x335)
2. **Вкажіть дату** - день, на який цей графік (формат: РРРР-ММ-ДД)
3. **Виберіть чергу** - з випадаючого списку
4. **Натисніть "Аналізувати графік"** або **"Порівняти всі черги"**

### Порівняння черг

Кнопка "Порівняти всі черги" дозволяє:
- Проаналізувати всі 12 черг одночасно
- Побачити кількість відключень для кожної черги
- Порівняти загальний час відключень
- Скопіювати результат у вигляді таблиці

## Експорт результатів

- **Копіювати JSON** - скопіює результат в буфер обміну
- **Зберегти JSON** - збереже результат у файл
- **Експорт в Календар** - створить календарний файл з подіями відключень
- **Очистити** - очистить результати

## ICS календарний файл

Після експорту в календар:
- Кожне відключення стає окремою подією
- Автоматичні нагадування за 15 та 5 хвилин до відключення
- Сумісність з Google Calendar, Apple Calendar, Outlook

## Доступні черги

Черга 1-1, 1-2, 2-1, 2-2, 3-1, 3-2, 4-1, 4-2, 5-1, 5-2, 6-1, 6-2

## Створення EXE файлу

Для перестворення EXE файлу запустіть:
```bash
build_exe.bat
```

або

```bash
python -m PyInstaller --onefile --windowed --name "ScheduleAnalyzer" main.py
```

EXE файл буде створено в папці `dist/`

## Технології

- Python 3.14
- Tkinter (GUI)
- Pillow (обробка зображень)
- iCalendar (генерація календарних файлів)
- pytz (часові зони)
- PyInstaller (створення EXE)

## Розробка

### Модульна архітектура

Проект організований у модульну структуру:
- `src/ui/` - UI компоненти
- `src/utils/` - утиліти (розрахунки, експорт)
- `src/themes/` - система тем

Це дозволяє легко розширювати функціонал та підтримувати код.

### Автоматична тема

Додаток автоматично визначає системну тему Windows (світла/темна) та адаптує інтерфейс відповідно.
